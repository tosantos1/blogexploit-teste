import Head from 'next/head'

import { useEffect, useState } from 'react';

import Link from 'next/link'

import styles from './styles.module.scss'
import { GetStaticProps } from 'next'

interface ResponseMedium {
  author: string;
  categories: [];
  content: string;
  description: string;
  guid: string;
  link: string;
  pubDate: Date;
  thumbnail: string;
  title: string;
  slug: string;
}
interface ResponseMediumProps {
  responsemedium: ResponseMedium[]
}

export default function PostList({ responsemedium }: ResponseMediumProps) {

  const [items, setItems] = useState<ResponseMedium[]>([])

  const token = process.env.NEXT_MEDIUM

  useEffect(() => {
    fetch(`https://api.rss2json.com/v1/api.json?rss_url=https%3A%2F%2Fmedium.com%2Ffeed%2Flegiti&api_key=${token}`)
      .then((response) => response.json())
      .then((data) => console.log(data.items))
  }, [])

  const trucate = (description) => {
    description?.length > 300 ? `${'...' + description.substring(0, 254)} + '...'` : description
  }

  return (
    <section className={styles.contentContainer}>
      <h1>Artigos</h1>
      {items.map(item => (
        <div className={styles.card} key={item.title}>
          <div className={styles.cardItem1} >
            <h1>{item.title}</h1>
            <p>Escrito por: {item.author}</p>
            <Link href={`${item.slug}`} prefetch ><a>Abrir Artigo</a></Link>
          </div>
          <div className={styles.cardItem2}>
            <img src={`${item.thumbnail}`} alt="" />
          </div>
        </div>
      ))}
    </section>
  );
}
